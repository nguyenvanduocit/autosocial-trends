---
source: github
title: thinking-machines-lab/tinker-cookbook
url: https://github.com/thinking-machines-lab/tinker-cookbook
date: 2025-12-15
---

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthinking-machines-lab%2Ftinker-cookbook)

Appearance settings

* Platform

  + AI CODE CREATION
    - [GitHub CopilotWrite better code with AI](https://github.com/features/copilot)
    - [GitHub SparkBuild and deploy intelligent apps](https://github.com/features/spark)
    - [GitHub ModelsManage and compare prompts](https://github.com/features/models)
    - [MCP RegistryNewIntegrate external tools](https://github.com/mcp)
  + DEVELOPER WORKFLOWS
    - [ActionsAutomate any workflow](https://github.com/features/actions)
    - [CodespacesInstant dev environments](https://github.com/features/codespaces)
    - [IssuesPlan and track work](https://github.com/features/issues)
    - [Code ReviewManage code changes](https://github.com/features/code-review)
  + APPLICATION SECURITY
    - [GitHub Advanced SecurityFind and fix vulnerabilities](https://github.com/security/advanced-security)
    - [Code securitySecure your code as you build](https://github.com/security/advanced-security/code-security)
    - [Secret protectionStop leaks before they start](https://github.com/security/advanced-security/secret-protection)
  + EXPLORE
    - [Why GitHub](https://github.com/why-github)
    - [Documentation](https://docs.github.com)
    - [Blog](https://github.blog)
    - [Changelog](https://github.blog/changelog)
    - [Marketplace](https://github.com/marketplace)

  [View all features](https://github.com/features)
* Solutions

  + BY COMPANY SIZE
    - [Enterprises](https://github.com/enterprise)
    - [Small and medium teams](https://github.com/team)
    - [Startups](https://github.com/enterprise/startups)
    - [Nonprofits](https://github.com/solutions/industry/nonprofits)
  + BY USE CASE
    - [App Modernization](https://github.com/solutions/use-case/app-modernization)
    - [DevSecOps](https://github.com/solutions/use-case/devsecops)
    - [DevOps](https://github.com/solutions/use-case/devops)
    - [CI/CD](https://github.com/solutions/use-case/ci-cd)
    - [View all use cases](https://github.com/solutions/use-case)
  + BY INDUSTRY
    - [Healthcare](https://github.com/solutions/industry/healthcare)
    - [Financial services](https://github.com/solutions/industry/financial-services)
    - [Manufacturing](https://github.com/solutions/industry/manufacturing)
    - [Government](https://github.com/solutions/industry/government)
    - [View all industries](https://github.com/solutions/industry)

  [View all solutions](https://github.com/solutions)
* Resources

  + EXPLORE BY TOPIC
    - [AI](https://github.com/resources/articles?topic=ai)
    - [Software Development](https://github.com/resources/articles?topic=software-development)
    - [DevOps](https://github.com/resources/articles?topic=devops)
    - [Security](https://github.com/resources/articles?topic=security)
    - [View all topics](https://github.com/resources/articles)
  + EXPLORE BY TYPE
    - [Customer stories](https://github.com/customer-stories)
    - [Events & webinars](https://github.com/resources/events)
    - [Ebooks & reports](https://github.com/resources/whitepapers)
    - [Business insights](https://github.com/solutions/executive-insights)
    - [GitHub Skills](https://skills.github.com)
  + SUPPORT & SERVICES
    - [Documentation](https://docs.github.com)
    - [Customer support](https://support.github.com)
    - [Community forum](https://github.com/orgs/community/discussions)
    - [Trust center](https://github.com/trust-center)
    - [Partners](https://github.com/partners)
* Open Source

  + COMMUNITY
    - [GitHub SponsorsFund open source developers](https://github.com/sponsors)
  + PROGRAMS
    - [Security Lab](https://securitylab.github.com)
    - [Maintainer Community](https://maintainers.github.com)
    - [Accelerator](https://github.com/accelerator)
    - [Archive Program](https://archiveprogram.github.com)
  + REPOSITORIES
    - [Topics](https://github.com/topics)
    - [Trending](https://github.com/trending)
    - [Collections](https://github.com/collections)
* Enterprise

  + ENTERPRISE SOLUTIONS
    - [Enterprise platformAI-powered developer platform](https://github.com/enterprise)
  + AVAILABLE ADD-ONS
    - [GitHub Advanced SecurityEnterprise-grade security features](https://github.com/security/advanced-security)
    - [Copilot for BusinessEnterprise-grade AI features](https://github.com/features/copilot/copilot-business)
    - [Premium SupportEnterprise-grade 24/7 support](https://github.com/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

[ ]
Include my email address so I can be contacted

Cancel
 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Cancel
 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthinking-machines-lab%2Ftinker-cookbook)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=thinking-machines-lab%2Ftinker-cookbook)

Appearance settings

Resetting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[thinking-machines-lab](/thinking-machines-lab)
/
**[tinker-cookbook](/thinking-machines-lab/tinker-cookbook)**
Public

* [Notifications](/login?return_to=%2Fthinking-machines-lab%2Ftinker-cookbook) You must be signed in to change notification settings
* [Fork
  229](/login?return_to=%2Fthinking-machines-lab%2Ftinker-cookbook)
* [Star
   2.5k](/login?return_to=%2Fthinking-machines-lab%2Ftinker-cookbook)

Post-training with Tinker

### License

[Apache-2.0 license](/thinking-machines-lab/tinker-cookbook/blob/main/LICENSE)

[2.5k
stars](/thinking-machines-lab/tinker-cookbook/stargazers) [229
forks](/thinking-machines-lab/tinker-cookbook/forks) [Branches](/thinking-machines-lab/tinker-cookbook/branches) [Tags](/thinking-machines-lab/tinker-cookbook/tags) [Activity](/thinking-machines-lab/tinker-cookbook/activity)

[Star](/login?return_to=%2Fthinking-machines-lab%2Ftinker-cookbook)

[Notifications](/login?return_to=%2Fthinking-machines-lab%2Ftinker-cookbook) You must be signed in to change notification settings

* [Code](/thinking-machines-lab/tinker-cookbook)
* [Issues
  27](/thinking-machines-lab/tinker-cookbook/issues)
* [Pull requests
  11](/thinking-machines-lab/tinker-cookbook/pulls)
* [Discussions](/thinking-machines-lab/tinker-cookbook/discussions)
* [Actions](/thinking-machines-lab/tinker-cookbook/actions)
* [Projects
  0](/thinking-machines-lab/tinker-cookbook/projects)
* [Security

  ### Uh oh!

  There was an error while loading. Please reload this page.](/thinking-machines-lab/tinker-cookbook/security)
* [Insights](/thinking-machines-lab/tinker-cookbook/pulse)

Additional navigation options

* [Code](/thinking-machines-lab/tinker-cookbook)
* [Issues](/thinking-machines-lab/tinker-cookbook/issues)
* [Pull requests](/thinking-machines-lab/tinker-cookbook/pulls)
* [Discussions](/thinking-machines-lab/tinker-cookbook/discussions)
* [Actions](/thinking-machines-lab/tinker-cookbook/actions)
* [Projects](/thinking-machines-lab/tinker-cookbook/projects)
* [Security](/thinking-machines-lab/tinker-cookbook/security)
* [Insights](/thinking-machines-lab/tinker-cookbook/pulse)

# thinking-machines-lab/tinker-cookbook

main

[Branches](/thinking-machines-lab/tinker-cookbook/branches)[Tags](/thinking-machines-lab/tinker-cookbook/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit   History[125 Commits](/thinking-machines-lab/tinker-cookbook/commits/main/) | | |
| [.github/workflows](/thinking-machines-lab/tinker-cookbook/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/thinking-machines-lab/tinker-cookbook/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [assets](/thinking-machines-lab/tinker-cookbook/tree/main/assets "assets") | | [assets](/thinking-machines-lab/tinker-cookbook/tree/main/assets "assets") |  |  |
| [docs](/thinking-machines-lab/tinker-cookbook/tree/main/docs "docs") | | [docs](/thinking-machines-lab/tinker-cookbook/tree/main/docs "docs") |  |  |
| [scripts](/thinking-machines-lab/tinker-cookbook/tree/main/scripts "scripts") | | [scripts](/thinking-machines-lab/tinker-cookbook/tree/main/scripts "scripts") |  |  |
| [tinker\_cookbook](/thinking-machines-lab/tinker-cookbook/tree/main/tinker_cookbook "tinker_cookbook") | | [tinker\_cookbook](/thinking-machines-lab/tinker-cookbook/tree/main/tinker_cookbook "tinker_cookbook") |  |  |
| [.gitignore](/thinking-machines-lab/tinker-cookbook/blob/main/.gitignore ".gitignore") | | [.gitignore](/thinking-machines-lab/tinker-cookbook/blob/main/.gitignore ".gitignore") |  |  |
| [.pre-commit-config.yaml](/thinking-machines-lab/tinker-cookbook/blob/main/.pre-commit-config.yaml ".pre-commit-config.yaml") | | [.pre-commit-config.yaml](/thinking-machines-lab/tinker-cookbook/blob/main/.pre-commit-config.yaml ".pre-commit-config.yaml") |  |  |
| [.sync\_state](/thinking-machines-lab/tinker-cookbook/blob/main/.sync_state ".sync_state") | | [.sync\_state](/thinking-machines-lab/tinker-cookbook/blob/main/.sync_state ".sync_state") |  |  |
| [AGENTS.md](/thinking-machines-lab/tinker-cookbook/blob/main/AGENTS.md "AGENTS.md") | | [AGENTS.md](/thinking-machines-lab/tinker-cookbook/blob/main/AGENTS.md "AGENTS.md") |  |  |
| [CHANGELOG.md](/thinking-machines-lab/tinker-cookbook/blob/main/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/thinking-machines-lab/tinker-cookbook/blob/main/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CLAUDE.md](/thinking-machines-lab/tinker-cookbook/blob/main/CLAUDE.md "CLAUDE.md") | | [CLAUDE.md](/thinking-machines-lab/tinker-cookbook/blob/main/CLAUDE.md "CLAUDE.md") |  |  |
| [CONTRIBUTING.md](/thinking-machines-lab/tinker-cookbook/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/thinking-machines-lab/tinker-cookbook/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [LICENSE](/thinking-machines-lab/tinker-cookbook/blob/main/LICENSE "LICENSE") | | [LICENSE](/thinking-machines-lab/tinker-cookbook/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/thinking-machines-lab/tinker-cookbook/blob/main/README.md "README.md") | | [README.md](/thinking-machines-lab/tinker-cookbook/blob/main/README.md "README.md") |  |  |
| [llms-full.txt](/thinking-machines-lab/tinker-cookbook/blob/main/llms-full.txt "llms-full.txt") | | [llms-full.txt](/thinking-machines-lab/tinker-cookbook/blob/main/llms-full.txt "llms-full.txt") |  |  |
| [llms.txt](/thinking-machines-lab/tinker-cookbook/blob/main/llms.txt "llms.txt") | | [llms.txt](/thinking-machines-lab/tinker-cookbook/blob/main/llms.txt "llms.txt") |  |  |
| [pyproject.toml](/thinking-machines-lab/tinker-cookbook/blob/main/pyproject.toml "pyproject.toml") | | [pyproject.toml](/thinking-machines-lab/tinker-cookbook/blob/main/pyproject.toml "pyproject.toml") |  |  |
| View all files | | |

## Repository files navigation

* README
* Contributing
* Apache-2.0 license

# Tinker Cookbook

[![](/thinking-machines-lab/tinker-cookbook/raw/main/assets/tinker-cover.png)](/thinking-machines-lab/tinker-cookbook/blob/main/assets/tinker-cover.png)

We provide two libraries for the broader community to customize their language models: `tinker` and `tinker-cookbook`.

* `tinker` is a training SDK for researchers and developers to fine-tune language models. You send API requests to us and we handle the complexities of distributed training.
* `tinker-cookbook` includes realistic examples of fine-tuning language models. It builds on the Tinker API and provides common abstractions to fine-tune language models.

## Installation

1. Sign up for Tinker through the [waitlist](https://thinkingmachines.ai/tinker).
2. Once you have access, create an API key from the [console](https://tinker-console.thinkingmachines.ai) and export it as environment variable `TINKER_API_KEY`.
3. Install tinker python client via `pip install tinker`
4. We recommend installing `tinker-cookbook` in a virtual env either with `conda` or `uv`. For running most examples, you can install via `pip install -e .`.

## Tinker

Refer to the [docs](https://tinker-docs.thinkingmachines.ai/training-sampling) to start from basics.
Here we introduce a few Tinker primitives - the basic components to fine-tune LLMs:

```
import tinker
service_client = tinker.ServiceClient()
training_client = service_client.create_lora_training_client(
  base_model="meta-llama/Llama-3.2-1B", rank=32,
)
training_client.forward_backward(...)
training_client.optim_step(...)
training_client.save_state(...)
training_client.load_state(...)

sampling_client = training_client.save_weights_and_get_sampling_client(name="my_model")
sampling_client.sample(...)
```

See [tinker\_cookbook/recipes/sl\_loop.py](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/sl_loop.py) and [tinker\_cookbook/recipes/rl\_loop.py](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/rl_loop.py) for minimal examples of using these primitives to fine-tune LLMs.

To download the weights of any model:

```
rest_client = service_client.create_rest_client()
future = rest_client.get_checkpoint_archive_url_from_tinker_path(sampling_client.model_path)
with open(f"model-checkpoint.tar.gz", "wb") as f:
    f.write(future.result())
```

### Tinker Cookbook

Besides these primitives, we also offer **Tinker Cookbook** (a.k.a. this repo), a library of a wide range of abstractions to help you customize training environments.
[`tinker_cookbook/recipes/sl_basic.py`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/sl_basic.py) and [`tinker_cookbook/recipes/rl_basic.py`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/rl_basic.py) contain minimal examples to configure supervised learning and reinforcement learning.

We also include a wide range of more sophisticated examples in the [`tinker_cookbook/recipes/`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes) folder:

1. **[Chat supervised learning](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/chat_sl)**: supervised fine-tuning on conversational datasets like Tulu3.
2. **[Math reasoning](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/math_rl)**: improve LLM reasoning capability by rewarding it for answering math questions correctly.
3. **[Preference learning](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/preference)**: showcase a three-stage RLHF pipeline: 1) supervised fine-tuning, 2) learning a reward model, 3) RL against the reward model.
4. **[Tool use](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/tool_use)**: train LLMs to better use retrieval tools to answer questions more accurately.
5. **[Prompt distillation](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/prompt_distillation)**: internalize long and complex instructions into LLMs.
6. **[Multi-Agent](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/recipes/multiplayer_rl)**: optimize LLMs to play against another LLM or themselves.

These examples are located in each subfolder, and their `README.md` files will walk you through the key implementation details, the commands to run them, and the expected performance.

### Documentation

The `docs/` directory contains a mirror of the Tinker documentation. These files are synced from our internal documentation site.

**Note:** The documentation files use MDX format (Markdown with JSX), which includes some syntax that isn't standard Markdown. You may see things like `import` statements, `<Callout>` components, or curly-brace expressions. These are artifacts of our documentation framework - the actual content should still be readable as Markdown.

If you find errors or want to improve the documentation, feel free to submit a PR editing files in `docs/`. We'll sync the changes back to our documentation site.

For the rendered documentation, visit [tinker-docs.thinkingmachines.ai](https://tinker-docs.thinkingmachines.ai).

### Import our utilities

Tinker cookbook includes several utilities. Here's a quick overview:

* [`renderers`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/renderers.py) converts tokens from/to structured chat message objects
* [`hyperparam_utils`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/hyperparam_utils.py) helps calculate hyperparameters suitable for LoRAs
* [`evaluation`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/eval/evaluators.py) provides abstractions for evaluating Tinker models and [`inspect_evaluation`](/thinking-machines-lab/tinker-cookbook/blob/main/tinker_cookbook/eval/inspect_evaluators.py) shows how to integrate with InspectAI to make evaluating on standard benchmarks easy.

## Contributing

This project is built in the spirit of open science and collaborative development. We believe that the best tools emerge through community involvement and shared learning.

We welcome PR contributions after our private beta is over. If you have any feedback, please email us at tinker@thinkingmachines.ai.

## Citation

If you use Tinker for your research, please cite it as:

```
Thinking Machines Lab, 2025. Tinker. https://thinkingmachines.ai/tinker/.
```

Or use this BibTeX citation:

```
@misc{tml2025tinker,
  author = {Thinking Machines Lab},
  title = {Tinker},
  year = {2025},
  url = {https://thinkingmachines.ai/tinker/},
}
```

## About

Post-training with Tinker

### Resources

[Readme](#readme-ov-file)

### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)

### Contributing

[Contributing](#contributing-ov-file)

### Uh oh!

There was an error while loading. Please reload this page.

[Activity](/thinking-machines-lab/tinker-cookbook/activity)

[Custom properties](/thinking-machines-lab/tinker-cookbook/custom-properties)

### Stars

[**2.5k**
stars](/thinking-machines-lab/tinker-cookbook/stargazers)

### Watchers

[**25**
watching](/thinking-machines-lab/tinker-cookbook/watchers)

### Forks

[**229**
forks](/thinking-machines-lab/tinker-cookbook/forks)

[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fthinking-machines-lab%2Ftinker-cookbook&report=thinking-machines-lab+%28user%29)

## [Releases](/thinking-machines-lab/tinker-cookbook/releases)

No releases published

## [Packages 0](/orgs/thinking-machines-lab/packages?repo_name=tinker-cookbook)

No packages published

## [Contributors 36](/thinking-machines-lab/tinker-cookbook/graphs/contributors)

* [![@joschu](https://avatars.githubusercontent.com/u/144178?s=64&v=4)](https://github.com/joschu)
* [![@Tiiiger](https://avatars.githubusercontent.com/u/19514537?s=64&v=4)](https://github.com/Tiiiger)
* [![@danobi](https://avatars.githubusercontent.com/u/824615?s=64&v=4)](https://github.com/danobi)
* [![@ruiqi-zhong](https://avatars.githubusercontent.com/u/22912421?s=64&v=4)](https://github.com/ruiqi-zhong)
* [![@claude](https://avatars.githubusercontent.com/u/81847?s=64&v=4)](https://github.com/claude)
* [![@kennyyu](https://avatars.githubusercontent.com/u/602219?s=64&v=4)](https://github.com/kennyyu)
* [![@devendrachaplot](https://avatars.githubusercontent.com/u/1102621?s=64&v=4)](https://github.com/devendrachaplot)
* [![@sergei-something-ai](https://avatars.githubusercontent.com/u/217649599?s=64&v=4)](https://github.com/sergei-something-ai)
* [![@andriigrynenko](https://avatars.githubusercontent.com/u/7255704?s=64&v=4)](https://github.com/andriigrynenko)
* [![@Xiuyu-Li](https://avatars.githubusercontent.com/u/20851944?s=64&v=4)](https://github.com/Xiuyu-Li)
* [![@BryanTegomoh](https://avatars.githubusercontent.com/u/67350434?s=64&v=4)](https://github.com/BryanTegomoh)
* [![@kzl-tml](https://avatars.githubusercontent.com/u/225927143?s=64&v=4)](https://github.com/kzl-tml)
* [![@myleott](https://avatars.githubusercontent.com/u/231798?s=64&v=4)](https://github.com/myleott)
* [![@vors](https://avatars.githubusercontent.com/u/816680?s=64&v=4)](https://github.com/vors)

[+ 22 contributors](/thinking-machines-lab/tinker-cookbook/graphs/contributors)

## Languages

* [Python
  100.0%](/thinking-machines-lab/tinker-cookbook/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Community](https://github.community/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.
