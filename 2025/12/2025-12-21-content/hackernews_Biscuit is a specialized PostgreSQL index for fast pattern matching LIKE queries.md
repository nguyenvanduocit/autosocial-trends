---
source: hackernews
title: Biscuit is a specialized PostgreSQL index for fast pattern matching LIKE queries
url: https://github.com/CrystallineCore/Biscuit
date: 2025-12-21
---

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCrystallineCore%2FBiscuit)

Appearance settings

* Platform

  + AI CODE CREATION
    - [GitHub CopilotWrite better code with AI](https://github.com/features/copilot)
    - [GitHub SparkBuild and deploy intelligent apps](https://github.com/features/spark)
    - [GitHub ModelsManage and compare prompts](https://github.com/features/models)
    - [MCP RegistryNewIntegrate external tools](https://github.com/mcp)
  + DEVELOPER WORKFLOWS
    - [ActionsAutomate any workflow](https://github.com/features/actions)
    - [CodespacesInstant dev environments](https://github.com/features/codespaces)
    - [IssuesPlan and track work](https://github.com/features/issues)
    - [Code ReviewManage code changes](https://github.com/features/code-review)
  + APPLICATION SECURITY
    - [GitHub Advanced SecurityFind and fix vulnerabilities](https://github.com/security/advanced-security)
    - [Code securitySecure your code as you build](https://github.com/security/advanced-security/code-security)
    - [Secret protectionStop leaks before they start](https://github.com/security/advanced-security/secret-protection)
  + EXPLORE
    - [Why GitHub](https://github.com/why-github)
    - [Documentation](https://docs.github.com)
    - [Blog](https://github.blog)
    - [Changelog](https://github.blog/changelog)
    - [Marketplace](https://github.com/marketplace)

  [View all features](https://github.com/features)
* Solutions

  + BY COMPANY SIZE
    - [Enterprises](https://github.com/enterprise)
    - [Small and medium teams](https://github.com/team)
    - [Startups](https://github.com/enterprise/startups)
    - [Nonprofits](https://github.com/solutions/industry/nonprofits)
  + BY USE CASE
    - [App Modernization](https://github.com/solutions/use-case/app-modernization)
    - [DevSecOps](https://github.com/solutions/use-case/devsecops)
    - [DevOps](https://github.com/solutions/use-case/devops)
    - [CI/CD](https://github.com/solutions/use-case/ci-cd)
    - [View all use cases](https://github.com/solutions/use-case)
  + BY INDUSTRY
    - [Healthcare](https://github.com/solutions/industry/healthcare)
    - [Financial services](https://github.com/solutions/industry/financial-services)
    - [Manufacturing](https://github.com/solutions/industry/manufacturing)
    - [Government](https://github.com/solutions/industry/government)
    - [View all industries](https://github.com/solutions/industry)

  [View all solutions](https://github.com/solutions)
* Resources

  + EXPLORE BY TOPIC
    - [AI](https://github.com/resources/articles?topic=ai)
    - [Software Development](https://github.com/resources/articles?topic=software-development)
    - [DevOps](https://github.com/resources/articles?topic=devops)
    - [Security](https://github.com/resources/articles?topic=security)
    - [View all topics](https://github.com/resources/articles)
  + EXPLORE BY TYPE
    - [Customer stories](https://github.com/customer-stories)
    - [Events & webinars](https://github.com/resources/events)
    - [Ebooks & reports](https://github.com/resources/whitepapers)
    - [Business insights](https://github.com/solutions/executive-insights)
    - [GitHub Skills](https://skills.github.com)
  + SUPPORT & SERVICES
    - [Documentation](https://docs.github.com)
    - [Customer support](https://support.github.com)
    - [Community forum](https://github.com/orgs/community/discussions)
    - [Trust center](https://github.com/trust-center)
    - [Partners](https://github.com/partners)
* Open Source

  + COMMUNITY
    - [GitHub SponsorsFund open source developers](https://github.com/sponsors)
  + PROGRAMS
    - [Security Lab](https://securitylab.github.com)
    - [Maintainer Community](https://maintainers.github.com)
    - [Accelerator](https://github.com/accelerator)
    - [Archive Program](https://archiveprogram.github.com)
  + REPOSITORIES
    - [Topics](https://github.com/topics)
    - [Trending](https://github.com/trending)
    - [Collections](https://github.com/collections)
* Enterprise

  + ENTERPRISE SOLUTIONS
    - [Enterprise platformAI-powered developer platform](https://github.com/enterprise)
  + AVAILABLE ADD-ONS
    - [GitHub Advanced SecurityEnterprise-grade security features](https://github.com/security/advanced-security)
    - [Copilot for BusinessEnterprise-grade AI features](https://github.com/features/copilot/copilot-business)
    - [Premium SupportEnterprise-grade 24/7 support](https://github.com/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

[ ]
Include my email address so I can be contacted

Cancel
 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Cancel
 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCrystallineCore%2FBiscuit)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=CrystallineCore%2FBiscuit)

Appearance settings

Resetting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CrystallineCore](/CrystallineCore)
/
**[Biscuit](/CrystallineCore/Biscuit)**
Public

* [Notifications](/login?return_to=%2FCrystallineCore%2FBiscuit) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FCrystallineCore%2FBiscuit)
* [Star
   123](/login?return_to=%2FCrystallineCore%2FBiscuit)

Biscuit is a specialized PostgreSQL index access method (IAM) designed for blazing-fast pattern matching on LIKE queries, with native support for multi-column searches. It eliminates the recheck overhead of trigram indexes while delivering significant performance improvements on wildcard-heavy queries.

### License

[View license](/CrystallineCore/Biscuit/blob/main/LICENSE)

[123
stars](/CrystallineCore/Biscuit/stargazers) [1
fork](/CrystallineCore/Biscuit/forks) [Branches](/CrystallineCore/Biscuit/branches) [Tags](/CrystallineCore/Biscuit/tags) [Activity](/CrystallineCore/Biscuit/activity)

[Star](/login?return_to=%2FCrystallineCore%2FBiscuit)

[Notifications](/login?return_to=%2FCrystallineCore%2FBiscuit) You must be signed in to change notification settings

* [Code](/CrystallineCore/Biscuit)
* [Issues
  0](/CrystallineCore/Biscuit/issues)
* [Pull requests
  0](/CrystallineCore/Biscuit/pulls)
* [Actions](/CrystallineCore/Biscuit/actions)
* [Projects
  0](/CrystallineCore/Biscuit/projects)
* [Security

  ### Uh oh!

  There was an error while loading. Please reload this page.](/CrystallineCore/Biscuit/security)
* [Insights](/CrystallineCore/Biscuit/pulse)

Additional navigation options

* [Code](/CrystallineCore/Biscuit)
* [Issues](/CrystallineCore/Biscuit/issues)
* [Pull requests](/CrystallineCore/Biscuit/pulls)
* [Actions](/CrystallineCore/Biscuit/actions)
* [Projects](/CrystallineCore/Biscuit/projects)
* [Security](/CrystallineCore/Biscuit/security)
* [Insights](/CrystallineCore/Biscuit/pulse)

# CrystallineCore/Biscuit

main

[Branches](/CrystallineCore/Biscuit/branches)[Tags](/CrystallineCore/Biscuit/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit   History[14 Commits](/CrystallineCore/Biscuit/commits/main/) | | |
| [docs](/CrystallineCore/Biscuit/tree/main/docs "docs") | | [docs](/CrystallineCore/Biscuit/tree/main/docs "docs") |  |  |
| [sql](/CrystallineCore/Biscuit/tree/main/sql "sql") | | [sql](/CrystallineCore/Biscuit/tree/main/sql "sql") |  |  |
| [src](/CrystallineCore/Biscuit/tree/main/src "src") | | [src](/CrystallineCore/Biscuit/tree/main/src "src") |  |  |
| [tests](/CrystallineCore/Biscuit/tree/main/tests "tests") | | [tests](/CrystallineCore/Biscuit/tree/main/tests "tests") |  |  |
| [.readthedocs.yaml](/CrystallineCore/Biscuit/blob/main/.readthedocs.yaml ".readthedocs.yaml") | | [.readthedocs.yaml](/CrystallineCore/Biscuit/blob/main/.readthedocs.yaml ".readthedocs.yaml") |  |  |
| [CHANGELOG.md](/CrystallineCore/Biscuit/blob/main/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/CrystallineCore/Biscuit/blob/main/CHANGELOG.md "CHANGELOG.md") |  |  |
| [LICENSE](/CrystallineCore/Biscuit/blob/main/LICENSE "LICENSE") | | [LICENSE](/CrystallineCore/Biscuit/blob/main/LICENSE "LICENSE") |  |  |
| [META.json](/CrystallineCore/Biscuit/blob/main/META.json "META.json") | | [META.json](/CrystallineCore/Biscuit/blob/main/META.json "META.json") |  |  |
| [Makefile](/CrystallineCore/Biscuit/blob/main/Makefile "Makefile") | | [Makefile](/CrystallineCore/Biscuit/blob/main/Makefile "Makefile") |  |  |
| [README.md](/CrystallineCore/Biscuit/blob/main/README.md "README.md") | | [README.md](/CrystallineCore/Biscuit/blob/main/README.md "README.md") |  |  |
| [biscuit.control](/CrystallineCore/Biscuit/blob/main/biscuit.control "biscuit.control") | | [biscuit.control](/CrystallineCore/Biscuit/blob/main/biscuit.control "biscuit.control") |  |  |
| View all files | | |

## Repository files navigation

* README
* License

# Biscuit - High-Performance Pattern Matching Index for PostgreSQL

[![License: MIT](https://camo.githubusercontent.com/fdf2982b9f5d7489dcf44570e714e3a15fce6253e0cc6b5aa61a075aac2ff71b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d79656c6c6f772e737667)](https://opensource.org/licenses/MIT)
[![PostgreSQL: 12+](https://camo.githubusercontent.com/404f7746b25606b6ea020d5fb097d8bc96a6ec2f30e277478fa8fbfaa73f46e2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f506f737467726553514c2d31362532422d626c75652e737667)](https://www.postgresql.org/)
[![Read the Docs](https://camo.githubusercontent.com/b3f1b802484456bdac1c084b0c36cfecce9194cba60d51d7cbf0e4b9e5aa708f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f52656164253230746865253230446f63732d3843413141463f6c6f676f3d72656164746865646f6373266c6f676f436f6c6f723d666666)](https://biscuit.readthedocs.io/)

**Biscuit** is a specialized PostgreSQL index access method (IAM) designed for blazing-fast pattern matching on `LIKE` and `ILIKE` queries, with native support for multi-column searches. It eliminates the recheck overhead of trigram indexes while delivering significant performance improvements on wildcard-heavy queries. It stands for *Bitmap Indexed Searching with Comprehensive Union and Intersection Techniques*.

---

## Version 2.1.4

### üõ†Ô∏è Build & Packaging

* Improved Makefile detection logic for CRoaring bitmap support by checking multiple common installation paths, increasing portability across systems and build environments.

### ‚ú® New Features

#### Build and configuration introspection

Added SQL functions to inspect Biscuit build-time configuration, useful for debugging,
reproducibility, and deployment verification.

* **`biscuit_version() ‚Üí text`**

Returns the Biscuit extension version string.

* **`biscuit_build_info() ‚Üí table`**

Returns detailed build-time configuration information.

* **`biscuit_build_info_json() ‚Üí text`**

Returns build configuration as a JSON string for automation and scripting.

#### Roaring Bitmap support introspection

Added built-in SQL functions to inspect CRoaring bitmap support in Biscuit.

* **`biscuit_has_roaring() ‚Üí boolean`**

Checks whether the extension was compiled with CRoaring bitmap support.

* **`biscuit_roaring_version() ‚Üí text`**

Returns the CRoaring library version if available.

#### Diagnostic views

Added a built-in diagnostic view for quick inspection of Biscuit status
and configuration.

* **`biscuit_status`**
  A single-row view providing an overview of:
  + extension version
  + CRoaring enablement
  + bitmap backend in use
  + total number of Biscuit indexes
  + combined on-disk index size

---

## **Installation**

### **Requirements**

* Build tools: `gcc`, `make`, `pg_config`
* Optional: CRoaring library for enhanced performance

### **From Source**

```
# Clone repository
git clone https://github.com/Crystallinecore/biscuit.git
cd biscuit

# Build and install
make
sudo make install

# Enable in PostgreSQL
psql -d your_database -c "CREATE EXTENSION biscuit;"
```

### **From PGXN**

```
pgxn install biscuit
psql -d your_database -c "CREATE EXTENSION biscuit;"
```

---

## **Quick Start**

### **Basic Usage**

```
-- Create a Biscuit index
CREATE INDEX idx_users_name ON users USING biscuit(name);

-- Query with wildcard patterns
SELECT * FROM users WHERE name LIKE '%john%';
SELECT * FROM users WHERE name NOT LIKE 'a%b%c';
SELECT COUNT(*) FROM users WHERE name LIKE '%test%';
```

### **Multi-Column Indexes**

```
-- Create multi-column index
CREATE INDEX idx_products_search
ON products USING biscuit(name, description, category);

-- Multi-column query (optimized automatically)
SELECT * FROM products
WHERE name LIKE '%widget%'
  AND description LIKE '%blue%'
  AND category LIKE 'electronics%'
ORDER BY score DESC
LIMIT 10;
```

### **Supported Data Types**

Biscuit automatically converts various types to searchable text:

```
-- Text types (native)
CREATE INDEX ON logs USING biscuit(message);

-- Numeric types (converted to sortable strings)
CREATE INDEX ON events USING biscuit(user_id, event_code);

-- Date/Time types (converted to sortable timestamps)
CREATE INDEX ON orders USING biscuit(order_date, customer_name);

-- Boolean (converted to 't'/'f')
CREATE INDEX ON flags USING biscuit(is_active, status);
```

---

## **How It Works**

### **Core Concept: Bitmap Position Indices**

Biscuit builds **two types of character-position bitmaps** for every string:

#### **1. Positive Indices (Forward)**

Tracks which records have character `c` at position `p`:

```
String: "Hello"
Bitmaps:
  H@0 ‚Üí {record_ids...}
  e@1 ‚Üí {record_ids...}
  l@2 ‚Üí {record_ids...}
  l@3 ‚Üí {record_ids...}
  o@4 ‚Üí {record_ids...}
```

#### **2. Negative Indices (Backward)**

Tracks which records have character `c` at position `-p` from the end:

```
String: "Hello"
Bitmaps:
  o@-1 ‚Üí {record_ids...}  (last char)
  l@-2 ‚Üí {record_ids...}  (second to last)
  l@-3 ‚Üí {record_ids...}
  e@-4 ‚Üí {record_ids...}
  H@-5 ‚Üí {record_ids...}
```

#### **3. Positive Indices (Case-insensitive)**

Tracks which records have character `c` at position `p`:

```
String: "Hello"
Bitmaps:
  h@0 ‚Üí {record_ids...}
  e@1 ‚Üí {record_ids...}
  l@2 ‚Üí {record_ids...}
  l@3 ‚Üí {record_ids...}
  o@4 ‚Üí {record_ids...}
```

#### **4. Negative Indices (Case-insensitive)**

Tracks which records have character `c` at position `-p` from the end:

```
String: "Hello"
Bitmaps:
  o@-1 ‚Üí {record_ids...}  (last char)
  l@-2 ‚Üí {record_ids...}  (second to last)
  l@-3 ‚Üí {record_ids...}
  e@-4 ‚Üí {record_ids...}
  h@-5 ‚Üí {record_ids...}
```

#### **5. Length Bitmaps**

Two types for fast length filtering:

* **Exact length**: `length[5]` ‚Üí all 5-character strings
* **Minimum length**: `length_ge[3]` ‚Üí all strings ‚â• 3 characters

---

### **Pattern Matching Algorithm**

#### **Example: `LIKE '%abc%def'`**

**Step 1: Parse pattern into parts**

```
Parts: ["abc", "def"]
Starts with %: YES
Ends with %: NO
```

**Step 2: Match first part as prefix**

```
-- "abc" must start at position 0
Candidates = pos[a@0] ‚à© pos[b@1] ‚à© pos[c@2]
```

**Step 3: Match last part at end (negative indexing)**

```
-- "def" must end at string end
Candidates = Candidates ‚à© neg[f@-1] ‚à© neg[e@-2] ‚à© neg[d@-3]
```

**Step 4: Apply length constraint**

```
-- String must be at least 6 chars (abc + def)
Candidates = Candidates ‚à© length_ge[6]
```

**Result: Exact matches, zero false positives**

---

### **Why It's Fast**

#### **1. Pure Bitmap Operations**

```
// Traditional approach (pg_trgm)
for each trigram in pattern:
    candidates = scan_trigram_index(trigram)
    for each candidate:
        if !heap_fetch_and_recheck(candidate):  // SLOW: Random I/O
            remove candidate

// Biscuit approach
for each character at position:
    candidates &= bitmap[char][pos]  // FAST: In-memory AND
// No recheck needed!
```

#### **2. Roaring Bitmaps**

Compressed bitmap representation:

* Sparse data: array of integers
* Dense data: bitset
* Automatic conversion for optimal memory

#### **3. Negative Indexing Optimization**

```
-- Pattern: '%xyz'
-- Traditional: Scan all strings, check suffix
-- Biscuit: Direct lookup in neg[z@-1] ‚à© neg[y@-2] ‚à© neg[x@-3]
```

---

## **12 Performance Optimizations**

### **1. Skip Wildcard Intersections**

```
// Pattern: "a_c" (underscore = any char)
// OLD: Intersect all 256 chars at position 1
// NEW: Skip position 1 entirely, only check a@0 and c@2
```

### **2. Early Termination on Empty**

```
result = bitmap[a][0];
result &= bitmap[b][1];
if (result.empty()) return empty;  // Don't process remaining chars
```

### **3. Avoid Redundant Bitmap Copies**

```
// OLD: Copy bitmap for every operation
// NEW: Operate in-place, copy only when branching
```

### **4. Optimized Single-Part Patterns**

Fast paths for common cases:

* **Exact**: `'abc'` ‚Üí Check position 0-2 and length = 3
* **Prefix**: `'abc%'` ‚Üí Check position 0-2 and length ‚â• 3
* **Suffix**: `'%xyz'` ‚Üí Check negative positions -3 to -1
* **Substring**: `'%abc%'` ‚Üí Check all positions, OR results

### **5. Skip Unnecessary Length Operations**

```
// Pure wildcard patterns
if (pattern == "%%%___%%")  // 3 underscores
    return length_ge[3];     // No character checks needed!
```

### **6. TID Sorting for Sequential Heap Access**

```
// Sort TIDs by (block_number, offset) before returning
// Converts random I/O into sequential I/O
// Uses radix sort for >5000 TIDs, quicksort for smaller sets
```

### **7. Batch TID Insertion**

```
// For bitmap scans, insert TIDs in chunks
for (i = 0; i < num_results; i += 10000) {
    tbm_add_tuples(tbm, &tids[i], batch_size, false);
}
```

### **8. Direct Roaring Iteration**

```
// OLD: Convert bitmap to array, then iterate
// NEW: Direct iterator, no intermediate allocation
roaring_uint32_iterator_t *iter = roaring_create_iterator(bitmap);
while (iter->has_value) {
    process(iter->current_value);
    roaring_advance_uint32_iterator(iter);
}
```

### **9. Batch Cleanup on Threshold**

```
// After 1000 deletes, clean tombstones from all bitmaps
if (tombstone_count >= 1000) {
    for each bitmap:
        bitmap &= ~tombstones;  // Batch operation
    tombstones.clear();
}
```

### **10. Aggregate Query Detection**

```
// COUNT(*), EXISTS, etc. don't need sorted TIDs
if (!scan->xs_want_itup) {
    skip_sorting = true;  // Save sorting time
}
```

### **11. LIMIT-Aware TID Collection**

```
// If LIMIT 10 in query, don't collect more than needed
if (limit_hint > 0 && collected >= limit_hint)
    break;  // Early termination
```

### **12. Multi-Column Query Optimization**

#### **Predicate Reordering**

Analyzes each column's pattern and executes in order of selectivity:

```
-- Query:
WHERE name LIKE '%common%'           -- Low selectivity
  AND sku LIKE 'PROD-2024-%'         -- High selectivity (prefix)
  AND description LIKE '%rare_word%' -- Medium selectivity

-- Execution order (Biscuit automatically reorders):
1. sku LIKE 'PROD-2024-%'         (PREFIX, priority=20, selectivity=0.02)
2. description LIKE '%rare_word%' (SUBSTRING, priority=35, selectivity=0.15)
3. name LIKE '%common%'           (SUBSTRING, priority=55, selectivity=0.60)
```

**Selectivity scoring formula:**

```
score = 1.0 / (concrete_chars + 1)
      - (underscore_count √ó 0.05)
      + (partition_count √ó 0.15)
      - (anchor_strength / 200)
```

**Priority tiers:**

1. **0-10**: Exact matches, many underscores
2. **10-20**: Non-% patterns with underscores
3. **20-30**: Strong anchored patterns (prefix/suffix)
4. **30-40**: Weak anchored patterns
5. **40-50**: Multi-partition patterns
6. **50-60**: Substring patterns (lowest priority)

---

## **Benchmarking**

### **Setup Test Data**

```
-- Create 1M row test table
CREATE TABLE benchmark (
    id SERIAL PRIMARY KEY,
    name TEXT,
    description TEXT,
    category TEXT,
    score FLOAT
);

INSERT INTO benchmark (name, description, category, score)
SELECT
    'Name_' || md5(random()::text),
    'Description_' || md5(random()::text),
    'Category_' || (random() * 100)::int,
    random() * 1000
FROM generate_series(1, 1000000);

-- Create indexes
CREATE INDEX idx_trgm ON benchmark
    USING gin(name gin_trgm_ops, description gin_trgm_ops);

CREATE INDEX idx_biscuit ON benchmark
    USING biscuit(name, description, category);

ANALYZE benchmark;
```

### **Run Benchmarks**

```
-- Single column, simple pattern
EXPLAIN ANALYZE
SELECT * FROM benchmark WHERE name LIKE '%abc%' LIMIT 100;

-- Multi-column, complex pattern
EXPLAIN ANALYZE
SELECT * FROM benchmark
WHERE name LIKE '%a%b'
  AND description LIKE '%bc%cd%'
ORDER BY score DESC
LIMIT 10;

-- Aggregate query (COUNT)
EXPLAIN ANALYZE
SELECT COUNT(*) FROM benchmark
WHERE name LIKE 'a%l%'
  AND category LIKE 'f%d';

-- Complex multi-part pattern
EXPLAIN ANALYZE
SELECT * FROM benchmark
WHERE description LIKE 'u%dc%x'
LIMIT 50;
```

### **View Index Statistics**

```
-- Show internal statistics
SELECT biscuit_index_stats('idx_biscuit'::regclass);
```

**Output:**

```
----------------------------------------------------
 Biscuit Index Statistics (FULLY OPTIMIZED)        +
 ==========================================        +
 Index: idx_biscuit                                +
 Active records: 1000002                           +
 Total slots: 1000002                              +
 Free slots: 0                                     +
 Tombstones: 0                                     +
 Max length: 44                                    +
 ------------------------                          +
 CRUD Statistics:                                  +
   Inserts: 0                                      +
   Updates: 0                                      +
   Deletes: 0                                      +
 ------------------------                          +
 Active Optimizations:                             +
   ‚úì 1. Skip wildcard intersections                +
   ‚úì 2. Early termination on empty                 +
   ‚úì 3. Avoid redundant copies                     +
   ‚úì 4. Optimized single-part patterns             +
   ‚úì 5. Skip unnecessary length ops                +
   ‚úì 6. TID sorting for sequential I/O             +
   ‚úì 7. Batch TID insertion                        +
   ‚úì 8. Direct bitmap iteration                    +
   ‚úì 9. Parallel bitmap scan support               +
   ‚úì 10. Batch cleanup on threshold                +
   ‚úì 11. Skip sorting for bitmap scans (aggregates)+
   ‚úì 12. LIMIT-aware TID collection                +
```

### Results

| Index | Command | Build Time |
| --- | --- | --- |
| **pg\_trgm** | `CREATE INDEX idx_trgm ...` | **20,358.655 ms** |
| **biscuit** | `CREATE INDEX idx_biscuit ...` | **2,734.310 ms** |

---

## **Use Cases**

### **1. Full-Text Search Applications**

```
-- E-commerce product search
CREATE INDEX idx_products ON products
    USING biscuit(name, brand, description);

SELECT * FROM products
WHERE name LIKE '%laptop%'
  AND brand LIKE 'ABC%'
  AND description LIKE '%gaming%'
ORDER BY price DESC
LIMIT 20;
```

### **2. Log Analysis**

```
-- Search error logs
CREATE INDEX idx_logs ON logs
    USING biscuit(message, source, level);

SELECT * FROM logs
WHERE message LIKE '%ERROR%connection%timeout%'
  AND source LIKE 'api.%'
  AND timestamp > NOW() - INTERVAL '1 hour'
LIMIT 100;
```

### **3. Customer Support / CRM**

```
-- Search tickets by multiple fields
CREATE INDEX idx_tickets ON tickets
    USING biscuit(subject, description, customer_name);

SELECT * FROM tickets
WHERE subject LIKE '%refund%'
  AND customer_name LIKE 'John%'
  AND status = 'open'
ORDER BY created_at DESC;
```

### **4. Code Search / Documentation**

```
-- Search code repositories
CREATE INDEX idx_files ON code_files
    USING biscuit(filename, content, author);

SELECT * FROM code_files
WHERE filename LIKE '%.py'
  AND content LIKE '%def%parse%json%'
  AND author LIKE 'team-%';
```

### **5. Analytics with Aggregates**

```
-- Fast COUNT queries (no sorting overhead)
CREATE INDEX idx_events ON events
    USING biscuit(event_type, user_agent, referrer);

SELECT COUNT(*) FROM events
WHERE event_type LIKE 'click%'
  AND user_agent LIKE '%Mobile%'
  AND referrer LIKE '%google%';
```

---

## **Configuration**

### **Build Options**

Enable CRoaring for better performance:

### **Index Options**

Currently, Biscuit doesn't expose tunable options. All optimizations are automatic.

---

## **Limitations and Trade-offs**

### **What Biscuit Does NOT Support**

1. **Regular expressions** - Only `LIKE` / `ILIKE` patterns with `%` and `_`
2. **Locale-specific collations** - String comparisons are byte-based
3. **Amcanorder = false** - Cannot provide ordered scans directly (but see below)

### **ORDER BY + LIMIT Behavior**

Biscuit doesn't support ordered index scans (`amcanorder = false`), BUT:

**PostgreSQL's planner handles this efficiently:**

```
SELECT * FROM table WHERE col LIKE '%pattern%' ORDER BY score LIMIT 10;
```

**Execution plan:**

```
Limit
  -> Sort (cheap, small result set)
    -> Biscuit Index Scan (fast filtering)
```

**Why this works:**

* Biscuit filters candidates extremely fast
* Result set is small after filtering
* Sorting 100-1000 rows in memory is negligible (<1ms)
* **Net result**: Still much faster than pg\_trgm with recheck overhead

### **Memory Usage**

Biscuit stores bitmaps in memory:

* Use `REINDEX` to rebuild if index grows too large

### **Write Performance**

* **INSERT**: Similar to B-tree (must update bitmaps)
* **UPDATE**: Two operations (remove old, insert new)
* **DELETE**: Marks as tombstone, batch cleanup at threshold

---

## **Comparison with pg\_trgm**

| Feature | Biscuit | pg\_trgm (GIN) |
| --- | --- | --- |
| **Wildcard patterns** | ‚úî Native, exact | ‚úî Approximate |
| **Recheck overhead** | ‚úî None (deterministic) | ‚úó Always required |
| **Multi-column** | ‚úî Optimized | ‚ö†Ô∏è Via btree\_gist |
| **Aggregate queries** | ‚úî Optimized | ‚úó Same cost |
| **ORDER BY + LIMIT** | ‚úî Works well | ‚úî Ordered scans |
| **Regex support** | ‚úó No | ‚úî Yes |
| **Similarity search** | ‚úó No | ‚úî Yes |
| **ILIKE support** | ‚úî Full | ‚úî Native |

**When to use Biscuit:**

* Wildcard-heavy `LIKE` / `ILIKE` queries (`%`, `_`)
* Multi-column pattern matching
* Need exact results (no false positives)
* `COUNT(*)` / aggregate queries
* High query volume, can afford memory

**When to use pg\_trgm:**

* Fuzzy/similarity search (`word <-> pattern`)
* Regular expressions
* Memory-constrained environments
* Write-heavy workloads

---

## **Development**

### **Build from Source**

```
git clone https://github.com/Crystallinecore/biscuit.git
cd biscuit

# Development build with debug symbols
make clean
CFLAGS="-g -O0 -DDEBUG" make

# Run tests
make installcheck

# Install
sudo make install
```

### **Testing**

```
# Unit tests
make installcheck

# Manual testing
psql -d testdb

CREATE EXTENSION biscuit;

-- Create test table
CREATE TABLE test (id SERIAL, name TEXT);
INSERT INTO test (name) VALUES ('hello'), ('world'), ('test');

-- Create index
CREATE INDEX idx_test ON test USING biscuit(name);

-- Test queries
EXPLAIN ANALYZE SELECT * FROM test WHERE name LIKE '%ell%';
```

### **Debugging**

Enable PostgreSQL debug logging:

```
SET client_min_messages = DEBUG1;
SET log_min_messages = DEBUG1;

-- Now run queries to see Biscuit's internal logs
SELECT * FROM test WHERE name LIKE '%pattern%';
```

---

## **Architecture Details**

### **Index Structure**

```
BiscuitIndex
‚îú‚îÄ‚îÄ num_columns: int
‚îú‚îÄ‚îÄ column_indices[]: ColumnIndex[]
‚îÇ   ‚îú‚îÄ‚îÄ pos_idx[256]: CharIndex    // Forward position bitmaps
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ entries[]: PosEntry[]
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pos: int
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ bitmap: RoaringBitmap
‚îÇ   ‚îú‚îÄ‚îÄ neg_idx[256]: CharIndex    // Backward position bitmaps
‚îÇ   ‚îú‚îÄ‚îÄ char_cache[256]: RoaringBitmap  // Character existence
‚îÇ   ‚îú‚îÄ‚îÄ length_bitmaps[]: RoaringBitmap[]  // Exact lengths
‚îÇ   ‚îî‚îÄ‚îÄ length_ge_bitmaps[]: RoaringBitmap[]  // Min lengths
‚îú‚îÄ‚îÄ insensitive_column_indices[]: ColumnIndex[]
‚îÇ   ‚îú‚îÄ‚îÄ insensitive_pos_idx[256]: CharIndex    // Forward position bitmaps
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ entries[]: PosEntry[]
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pos: int
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ bitmap: RoaringBitmap
‚îÇ   ‚îú‚îÄ‚îÄ insensitive_neg_idx[256]: CharIndex    // Backward position bitmaps
‚îÇ   ‚îî‚îÄ‚îÄ insensitive_char_cache[256]: RoaringBitmap  // Character existence
‚îú‚îÄ‚îÄ tids[]: ItemPointerData[]      // Record TIDs
‚îú‚îÄ‚îÄ column_data_cache[][]: char**  // Cached string data
‚îî‚îÄ‚îÄ tombstones: RoaringBitmap      // Deleted records
```

### **Query Execution Flow**

```
1. biscuit_rescan()
   ‚îú‚îÄ> Parse LIKE pattern into parts
   ‚îú‚îÄ> Analyze pattern selectivity (multi-column)
   ‚îú‚îÄ> Reorder predicates by priority
   ‚îî‚îÄ> For each predicate:
       ‚îú‚îÄ> biscuit_query_column_pattern()
       ‚îÇ   ‚îú‚îÄ> Check fast paths (empty, %, pure wildcards)
       ‚îÇ   ‚îú‚îÄ> Match pattern parts using bitmaps
       ‚îÇ   ‚îî‚îÄ> Return candidate bitmap
       ‚îî‚îÄ> Intersect with previous candidates

2. biscuit_collect_tids_optimized()
   ‚îú‚îÄ> Detect aggregate vs. regular query
   ‚îú‚îÄ> Estimate LIMIT hint
   ‚îú‚îÄ> Collect TIDs from final bitmap
   ‚îú‚îÄ> Sort if needed (skip for aggregates)
   ‚îî‚îÄ> Apply LIMIT early termination

3. biscuit_gettuple() or biscuit_getbitmap()
   ‚îî‚îÄ> Return results to PostgreSQL executor
```

---

## **Contributing**

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing`)
3. Make your changes with tests
4. Submit a pull request

### **Areas for Contribution**

* [ ]  Implement `amcanorder` for native sorted scans
* [ ]  Add statistics collection for better cost estimation
* [ ]  Support for more data types (JSON, arrays)
* [ ]  Parallel index build
* [ ]  Index compression options

---

## **License**

MIT License - See LICENSE file for details.

---

## **Author**

Sivaprasad Murali

* Email: sivaprasad.off@gmail.com
* GitHub: [@Crystallinecore](https://github.com/Crystallinecore)

---

## **Acknowledgments**

* PostgreSQL community for the extensible index AM framework
* CRoaring library for efficient bitmap operations
* Inspired by the need for faster LIKE query performance in production systems

---

## **Support**

* **Issues**: [GitHub Issues](https://github.com/Crystallinecore/biscuit/issues)
* **Discussions**: [GitHub Discussions](https://github.com/Crystallinecore/biscuit/discussions)
* **Documentation**: [ReadTheDocs Page](https://biscuit.readthedocs.io/)

---

**Happy pattern matching! Grab a biscuit üç™ when pg\_trgm feels half-baked!**

---

## About

Biscuit is a specialized PostgreSQL index access method (IAM) designed for blazing-fast pattern matching on LIKE queries, with native support for multi-column searches. It eliminates the recheck overhead of trigram indexes while delivering significant performance improvements on wildcard-heavy queries.

### Resources

[Readme](#readme-ov-file)

### License

[View license](#License-1-ov-file)

### Uh oh!

There was an error while loading. Please reload this page.

[Activity](/CrystallineCore/Biscuit/activity)

### Stars

[**123**
stars](/CrystallineCore/Biscuit/stargazers)

### Watchers

[**2**
watching](/CrystallineCore/Biscuit/watchers)

### Forks

[**1**
fork](/CrystallineCore/Biscuit/forks)

[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FCrystallineCore%2FBiscuit&report=CrystallineCore+%28user%29)

## [Releases 2](/CrystallineCore/Biscuit/releases)

[v2.0.1 - Bug Fixes and NOT LIKE support

Latest

Dec 6, 2025](/CrystallineCore/Biscuit/releases/tag/v2.0.1)

[+ 1 release](/CrystallineCore/Biscuit/releases)

## [Packages 0](/users/CrystallineCore/packages?repo_name=Biscuit)

No packages published

## Languages

* [C
  73.1%](/CrystallineCore/Biscuit/search?l=c)
* [Shell
  20.5%](/CrystallineCore/Biscuit/search?l=shell)
* [PLpgSQL
  4.7%](/CrystallineCore/Biscuit/search?l=plpgsql)
* [Makefile
  1.7%](/CrystallineCore/Biscuit/search?l=makefile)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Community](https://github.community/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.
